<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HolyCross Medical Center - Patients</title>
   
    <link href="https://stackpath.bootstrapcdn.com/bootswatch/4.4.1/united/bootstrap.min.css" rel="stylesheet" integrity="sha384-bzjLLgZOhgXbSvSc5A9LWWo/mSIYf7U7nFbmYIB2Lgmuiw3vKGJuu+abKoaTx4W6" crossorigin="anonymous">
    <link rel="stylesheet" href="css/main-styles.css">
   
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.js" integrity="sha256-66f6uQTQkvHF8jpniLWJjnteEfmQaC/tATFew/nTBA8=" crossorigin="anonymous"></script>
</head>
<body>
    <header>
        <!-- Start Navbar -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
            <a style="padding-right: 2em;" class="navbar-brand" href="index.html">HolyCross Medical Center</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01"
                    aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarColor01">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item" style="border-left: white 1px solid; padding-left: 2em; padding-right: 2em;">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item active" style="border-left: white 1px solid; padding-left: 2em; padding-right: 2em;">
                        <a class="nav-link" href="patients.html">Patients</a>
                    </li>
                </ul>
                <form class="form-inline my-2 my-lg-0">
                    <span style="color: #ffffff; margin-right: 0em;" >Welcome, Guest</span>
                </form>
            </div>
        </nav>    
        <!-- End Navbar -->
    </header>

    <!-- Start main-content -->
    <main>
        <div style="padding-top: 1em;" class="container">
            <!-- main content here -->
            <h3>
                Patients Registration
            </h3>
            <hr>
            <form>
                <fieldset>
                    <legend></legend>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label for="patientIdNumber">*Patient ID No:</label>
                                <input pattern="(P|EP)-\d{3}-\d{6}" class="form-control" type="text" value="EP-001-000001" name="patientIdNumber" id="patientIdNumber" placeholder="EP-XXX-XXXXXX" required autofocus>
                                <small class="form-text text-muted">Enter the Patient ID Number, in the specified format</small>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="firstName">*First Name:</label>
                                <input class="form-control" type="text" name="firstName" id="firstName" value="Smith"  placeholder="Enter First Name" required>
                                <small class="form-text text-muted">Enter the Patient's First Name</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="middleInitials">Middle Initial(s):</label>
                                <input class="form-control" type="text" name="middleInitials" id="middleInitials" value="j" placeholder="Enter Middle Initial(s)">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="lastName">*Last Name:</label>
                                <input class="form-control" type="text" name="lastName" id="lastName" value="Ann" placeholder="Enter Last Name" required>
                                <small class="form-text text-muted">Enter the Patient's Last Name</small>
                            </div>
                        </div>                        
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="dateOfBirth">*Date of birth:</label>
                                <input class="form-control" type="date" name="dateOfBirth" id="dateOfBirth" required>
                                <small class="form-text text-muted">Enter the Patient's Date of birth</small>
                            </div>
                        </div>                        
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="ddlDepartment">*Department:</label>
                                <select required class="form-control" id="ddlDepartment" name="ddlDepartment">
                                    <option value="">Select...</option>
                                    <option value="Cardiology">Cardiology</option>
                                    <option value="Ear, Nose and Throat">Ear, Nose and Throat</option>
                                    <option value="Primary Care">Primary Care</option>
                                    <option value="[Unassigned]">[Unassigned]</option>
                                </select>
                                <small class="form-text text-muted">Select the department providing care</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label>*Is this an Out-patient?</label><br>
                            <div class="form-group">
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input required type="radio" name="radioIsOutPatient" id="radioIsOutPatientYes" class="custom-control-input" value="Yes">
                                    <label for="radioIsOutPatientYes" class="custom-control-label">Yes</label>
                                </div>
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input required type="radio" name="radioIsOutPatient" id="radioIsOutPatientNo" class="custom-control-input" value="No">
                                    <label for="radioIsOutPatientNo" class="custom-control-label">No</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <!-- <input style="vertical-align: middle;" type="checkbox" name="chkElderlyPatients" id="chkElderlyPatients" value="showElderlyPatients">
				            <label style="vertical-align: baseline;" for="chkElderlyPatients">Elderly Patients only</label> -->
                        </div>
                        <div class="col-md-3">
                            <!-- <input style="vertical-align: middle;" type="checkbox" name="chkShowOutPatients" id="chkShowOutPatients" value="showOutPatients">
				            <label style="vertical-align: baseline;" for="chkShowOutPatients">Out-Patients only</label> -->
                        </div>
                        <div style="text-align: right;" class="col-md-6">
                            <button style="padding: .5em 4em;" id="btnReset" type="reset" class="btn btn-secondary btn-inline">Reset</button>
                            <button style="margin-left: 1em; padding: .5em 4em;" id="btnRegisterPatient" type="submit" class="btn btn-primary btn-inline">Register Patient</button>
                        </div>
                    </div>
                </fieldset>
            </form>
            <div class="row">
                <div class="col-md-3">
                    <input style="vertical-align: middle;" type="checkbox" name="chkElderlyPatients" id="chkElderlyPatients" value="showElderlyPatients" onchange="showBoth();">
                    <label style="vertical-align: baseline;" for="chkElderlyPatients">Show Elderly Patients only</label>
                </div>
                <div class="col-md-3">
                    <input style="vertical-align: middle;" type="checkbox" name="chkShowOutPatients" id="chkShowOutPatients" value="showOutPatients" onchange="showBoth();">
                    <label style="vertical-align: baseline;" for="chkShowOutPatients">Show Out-Patients only</label>
                </div>
                <div style="text-align: right;" class="col-md-6">
                    &nbsp;
                </div>
            </div>            
            <div style="margin-top: 1em;" id="divPatientsList" style="font-size: 1em">
                <table class="table table-striped"  id="myTable">
                    <thead>
                        <tr>
                            <th scope="col">Patient ID No</th>
                            <th scope="col">First Name</th>
                            <th scope="col">Middle Initial(s)</th>
                            <th scope="col">Last Name</th>
                            <th scope="col">Date of birth</th>
                            <th scope="col">Department</th>
                            <th scope="col">Out-patient?</th>
                        </tr>
                    </thead>
                    <tbody id="tbodyPatientsList"></tbody>
                </table>
            </div>
        </div>
    </main>
    <!-- End main-content -->

    <!-- Start footer -->
    <footer>
        <div>
            <span style="margin-left: 1em;">O. Kalu ::: CS472-WAP</span>
            <span style="float: right;margin-right: 1em;">HCMC &copy; May 2020</span>
        </div>
    </footer>

    <script>
    
        $('form').on('submit', function(e) {
            e.preventDefault();
            addRow();
            return false;
        });

        function age(birthdate) { 
            const today = new Date(); 
            const age = today.getFullYear() - birthdate.getFullYear() - 
                        (today.getMonth() < birthdate.getMonth() || 
                        (today.getMonth() === birthdate.getMonth() && today.getDate() < birthdate.getDate()));
                       
            return age;
        }

        function showBoth()
        {
            var inputElder,inputOut, filter, table, tr, td, i, txtValue; 
            inputElder = document.getElementById("chkElderlyPatients").checked;  
            inputOut = document.getElementById("chkShowOutPatients").checked;

            table = document.getElementById("tbodyPatientsList");
            tr = table.getElementsByTagName("tr");

           // console.log(inputElder +" out:"+inputOut);
            for (i = 0; i < tr.length; i++) {
                td_elder = tr[i].getElementsByTagName("td")[4];    
                td_out = tr[i].getElementsByTagName("td")[6];
                //console.log(inputElder +"::"+ td_elder);
                if(inputElder && inputOut && td_elder && td_out){
                    txtElder = td_elder.textContent || td_elder.innerText;
                    const birthdate = new Date(txtElder); 
                    const ageValue = age(birthdate);
                    txtOut = td_out.textContent || td_out.innerText; 
                    //console.log(txtOut.toUpperCase()+":"+txtOut.toUpperCase().indexOf("YES") +" age:"+ ageValue);
                    if (txtOut.toUpperCase().indexOf("YES") == -1 || ageValue < 65) {
                        tr[i].style.display = "none";
                    } else {
                        tr[i].style.display = "";
                    }

                }else if(inputElder){
                    showElderPatient();
                }else{
                    showOutPatient();
                }
                if (td) {
                    txtValue = td.textContent || td.innerText;
                    const birthdate = new Date(txtValue); 
                    const ageValue = age(birthdate); 
                   
                    if(filter) {
                        //console.log(ageValue + ":"+ filter);
                        if (ageValue < 65){
                           // console.log(ageValue + ":"+ filter);
                            tr[i].style.display = "none"; 
                        }  
                    } else {
                        tr[i].style.display = "";
                    }
                }       
            }
        }

        function showElderPatient()
        {
            var input, filter, table, tr, td, i, txtValue; 
            input = document.getElementById("chkElderlyPatients").checked;  
            filter = input;
            table = document.getElementById("tbodyPatientsList");
            tr = table.getElementsByTagName("tr");

            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td")[4];
                if (td) {
                    txtValue = td.textContent || td.innerText;
                    const birthdate = new Date(txtValue); 
                    const ageValue = age(birthdate); 
                    if(filter) {
                        console.log(ageValue + ":"+ filter);
                        if (ageValue < 65){
                          //  console.log(ageValue + ":"+ filter);
                            tr[i].style.display = "none"; 
                        }  
                    } else {
                        tr[i].style.display = "";
                    }
                }       
            }
        }


        function showOutPatient()
        {
            var input, filter, table, tr, td, i, txtValue; 
            input = document.getElementById("chkShowOutPatients").checked; 
            if(input) filter = "yes".toUpperCase();
            else filter = "";
            table = document.getElementById("tbodyPatientsList");
            tr = table.getElementsByTagName("tr");

            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td")[6];
                if (td) {
                    txtValue = td.textContent || td.innerText;
                    // console.log(txtValue +": F: "+filter+" :"+txtValue.toUpperCase().indexOf(filter));
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }       
            }
        }

        function addRow() {
             
            let table = document.getElementById("tbodyPatientsList");
 
            var row = table.insertRow(0);  
            var cell1 = row.insertCell(0).innerHTML = document.getElementById("patientIdNumber").value;
            var cell2 = row.insertCell(1).innerHTML = document.getElementById("firstName").value;
            var cell3 = row.insertCell(2).innerHTML = document.getElementById("middleInitials").value;
            var cell4 = row.insertCell(3).innerHTML = document.getElementById("lastName").value;
            var cell5 = row.insertCell(4).innerHTML = document.getElementById("dateOfBirth").value;
            var e = document.getElementById("ddlDepartment");
            var cell6 = row.insertCell(5).innerHTML = e.options[e.selectedIndex].text;

            var radioYes = document.getElementById("radioIsOutPatientYes");
            var radioNo = document.getElementById("radioIsOutPatientNo");
            if(radioYes.checked){
                var cell7 = row.insertCell(6).innerHTML = radioYes.value;
            }
            else{
                var cell7 = row.insertCell(6).innerHTML = radioNo.value;
            }
        }
    </script>
</body>
</html>